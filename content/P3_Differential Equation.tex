\chapter{Ordinary Differential Equation}

\section{Typology of Differential Equation}

\section{Solution(s) of ODE}

\subsection{Solution Space of ODE}
\begin{theorem}[Solution Space of Homogeneous Linear Differential Equations]
Consider the n-th order linear homogeneous differential equation:
\[
a_n(x)\frac{d^ny}{dx^n} + a_{n-1}(x)\frac{d^{n-1}y}{dx^{n-1}} + \cdots + a_1(x)\frac{dy}{dx} + a_0(x)y = 0
\]
where $a_i(x)$ are continuous functions on an interval $I$ and $a_n(x) \neq 0$ for all $x \in I$. 
The set $S$ of all solutions to this equation forms a vector space over the field of real numbers.
\end{theorem}

\begin{proof}
To prove that $S$ is a vector space, we need to verify the eight vector space axioms:

1. Closure under addition: Let $y_1(x)$ and $y_2(x)$ be solutions to the equation. Then:
   \[
   a_n(x)\frac{d^n(y_1+y_2)}{dx^n} + \cdots + a_0(x)(y_1+y_2) = 
   \]
   \[
   \left(a_n(x)\frac{d^ny_1}{dx^n} + \cdots + a_0(x)y_1\right) + 
   \left(a_n(x)\frac{d^ny_2}{dx^n} + \cdots + a_0(x)y_2\right) = 0 + 0 = 0
   \]
   Thus, $y_1 + y_2$ is also a solution and belongs to $S$.

2. Closure under scalar multiplication: Let $y(x)$ be a solution to the equation and $c$ be any scalar. Then:
   \[
   a_n(x)\frac{d^n(cy)}{dx^n} + \cdots + a_0(x)(cy) = 
   c\left(a_n(x)\frac{d^ny}{dx^n} + \cdots + a_0(x)y\right) = c \cdot 0 = 0
   \]
   Thus, $cy$ is also a solution and belongs to $S$.

3. Commutativity of addition: For any $y_1, y_2 \in S$, clearly $y_1 + y_2 = y_2 + y_1$.

4. Associativity of addition: For any $y_1, y_2, y_3 \in S$, clearly $(y_1 + y_2) + y_3 = y_1 + (y_2 + y_3)$.

5. Additive identity: The zero function $y(x) = 0$ is a solution to the equation and acts as the additive identity.

6. Additive inverse: If $y(x)$ is a solution, then $-y(x)$ is also a solution, and $y + (-y) = 0$.

7. Scalar multiplication properties: For any scalars $c$ and $d$, and any $y, y_1, y_2 \in S$:
   \begin{itemize}
   \item $c(dy) = (cd)y$
   \item $1y = y$
   \item $(c+d)y = cy + dy$
   \item $c(y_1 + y_2) = cy_1 + cy_2$
   \end{itemize}
   These properties follow directly from the properties of real numbers and functions.

Therefore, the set $S$ of all solutions to the given linear homogeneous differential equation satisfies all the axioms of a vector space over the field of real numbers.
\end{proof}

\begin{theorem}[Solution Space of Non-Homogeneous Linear Differential Equations]
Consider the n-th order linear non-homogeneous differential equation:
\[
a_n(x)\frac{d^ny}{dx^n} + a_{n-1}(x)\frac{d^{n-1}y}{dx^{n-1}} + \cdots + a_1(x)\frac{dy}{dx} + a_0(x)y = f(x)
\]
where $a_i(x)$ and $f(x)$ are continuous functions on an interval $I$ and $a_n(x) \neq 0$ for all $x \in I$.
The set $S$ of all solutions to this equation forms an affine space over the vector space $V$ of solutions to the corresponding homogeneous equation.
\end{theorem}
\begin{proof}
To prove that $S$ is an affine space, we need to verify the following properties:

Existence of a vector space action: Let $V$ be the vector space of solutions to the corresponding homogeneous equation. We define an action $+: S \times V \to S$ as follows:
For any $y \in S$ and $v \in V$, $y + v$ is defined as the usual addition of functions.
Associativity of the action: For any $y \in S$ and $v, w \in V$:
\[
(y + v) + w = y + (v + w)
\]
This follows from the associativity of function addition.

Identity element: The zero function $0 \in V$ acts as the identity element:
\[
y + 0 = y \quad \text{for all } y \in S
\]
Uniqueness of displacement vector: For any $y_1, y_2 \in S$, there exists a unique $v \in V$ such that $y_1 + v = y_2$.

To prove these properties:

Well-definedness of the action:
Let $y \in S$ and $v \in V$. Then:
\[
a_n(x)\frac{d^n(y+v)}{dx^n} + \cdots + a_0(x)(y+v) =
\]
\[
\left(a_n(x)\frac{d^ny}{dx^n} + \cdots + a_0(x)y\right) +
\left(a_n(x)\frac{d^nv}{dx^n} + \cdots + a_0(x)v\right) = f(x) + 0 = f(x)
\]
Thus, $y + v \in S$.
Associativity of the action: This follows directly from the associativity of function addition.
Identity element: The zero function clearly satisfies this property.
Uniqueness of displacement vector:
Let $y_1, y_2 \in S$. Define $v = y_2 - y_1$. Then:
\[
a_n(x)\frac{d^nv}{dx^n} + \cdots + a_0(x)v =
\]
\[
\left(a_n(x)\frac{d^ny_2}{dx^n} + \cdots + a_0(x)y_2\right) -
\left(a_n(x)\frac{d^ny_1}{dx^n} + \cdots + a_0(x)y_1\right) = f(x) - f(x) = 0
\]
Thus, $v \in V$, and clearly $y_1 + v = y_2$. Uniqueness follows from the fact that if $w \in V$ also satisfies $y_1 + w = y_2$, then $v - w = 0$, so $v = w$.
Affine combination property:
For $y_1, y_2, \ldots, y_n \in S$ and scalars $\alpha_1, \alpha_2, \ldots, \alpha_n$ with $\sum_{i=1}^n \alpha_i = 1$:
\[
\sum_{i=1}^n \alpha_i y_i = y_1 + \sum_{i=2}^n \alpha_i (y_i - y_1)
\]
Since each $y_i - y_1 \in V$ and $V$ is a vector space, $\sum_{i=2}^n \alpha_i (y_i - y_1) \in V$.
Therefore, $\sum_{i=1}^n \alpha_i y_i \in S$.

Therefore, the set $S$ of all solutions to the given linear non-homogeneous differential equation satisfies all the properties of an affine space over the vector space $V$ of solutions to the corresponding homogeneous equation.
\end{proof}

\subsection{Solvable Conditions of ODEs}

In most cases, it is sure that an n-order linear ODE is solvable (has at least one solution).

\begin{theorem}[Existence of Solutions for Linear ODE]
Consider an \(n\)-th order linear differential equation:
\[
L(y) = a_n(x) \frac{d^n y}{dx^n} + a_{n-1}(x) \frac{d^{n-1} y}{dx^{n-1}} + \cdots + a_1(x) \frac{dy}{dx} + a_0(x) y = f(x),
\]
where \(f(x)\) is a given function and \(a_0(x), a_1(x), \dots, a_n(x)\) are the coefficient functions.

If the right-hand side \(f(x)\) is a continuous function in some interval \([a,b]\), and the coefficient functions \(a_0(x), a_1(x), \dots, a_n(x)\) are also continuous on this interval, then a solution to the differential equation \textit{exists} on this interval.

This implies that regardless of the specific form of \(f(x)\), as long as it is continuous (even only continuous in [$a,b$]), and the coefficients are continuous as well, we can guarantee the existence of a solution in a certain interval.
\end{theorem}
In general, for ordinary differential equations, \textit{continuity} is more fundamental than \textit{differentiability}. If \(f(x)\) and the coefficient functions are continuous, then a solution exists. If \(f(x)\) and the coefficients are differentiable, then the solution may be smoother (i.e., higher-order derivatives exist), but the existence of the solution only requires continuity.

We can show this with Existence-Uniqueness Theorem when discuss the existence of solutions to linear ODEs later.

Now we discuss the existence and uniqueness of the particular solution to linear ODEs. First, it is pretty clear that, without extra \textbf{valid} information provided as in IVP or BVP, we can only get a general solution that contains a constant term $C$, which can be taken as a subset of $\mathbf{C}^n(\R)$: the set of all real functions that are n-th order differentiable.

When it comes to the existence of a distinct, particular solution, we may refer to Existence and Uniqueness Theorem.

\begin{theorem}[Existence-Uniqueness Theorem(Picard-Lindel√∂f)]
Let $\frac{dy}{dx} = f(x, y)$
be an ODE subject to the initial condition \( y(x_0) = y_0 \).

If:

(a) \( f(x, y) \) is continuous for every \( (x, y) \in D \), where \( D \) is a rectangle bounded by the straight lines \( x = x_0 \pm a \) and \( y = y_0 \pm b \) in \( \mathbb{R} \).

(b) \( f(x, y) \) satisfies the Lipschitz condition of order 1, namely:
\[
|f(x, y_1) - f(x, y_2)| \leq K |y_1 - y_2|,
\]
where \( K \) is a constant dependent on \( D \), then there exists a unique solution \( y = \bar{y}(x) \) to the ODE such that \( y_0 = \bar{y}(x_0) \) for all \( x \in [x_0 - \delta, x_0 + \delta] \), where
\[
\delta < \min \left\{ a, \frac{b}{M}, \frac{1}{K} \right\} \quad \text{and} \quad M = \max_{(x, y) \in D} f(x, y).
\]
\end{theorem}
\begin{remark}
    The proof the the theorem is not compulsory to most people, and may take some time to show the technique applied (Picard iteration), but you may find it \href{https://en.wikipedia.org/wiki/Picard%E2%80%93Lindel%C3%B6f_theorem}{here} in case that you already have some basics of real analysis.
\end{remark}
     We also show how can we derive Lipschitz Continuity from the general definition to continuity in function. For consistency with the theorem, we will give the definition and discuss in binary functions.
\begin{definition}[Continuity]
    A function \( f(x, y) \) is continuous at \( (x_0, y_0) \) if for any \( \epsilon > 0 \), there exists \( \delta > 0 \) such that:
\[
|(x, y) - (x_0, y_0)| < \delta \quad \implies \quad |f(x, y) - f(x_0, y_0)| < \epsilon.
\]
This ensures small changes in \( (x, y) \) produce small changes in \( f(x, y) \).
\end{definition}
Lipschitz continuity is a stricter condition. A function is Lipschitz continuous in \( y \) if there exists \( K > 0 \) such that for any \( x \in D \) and all \( y_1, y_2 \in D \),
\[
|f(x, y_1) - f(x, y_2)| \leq K |y_1 - y_2|.
\]
While continuity guarantees no jumps, Lipschitz continuity controls the rate of change, bounding it by \( K \).

Lipschitz continuity implies continuity: given \( f(x, y) \) Lipschitz continuous, for any \( y_1, y_2 \),
\[
|f(x, y_1) - f(x, y_2)| \leq K |y_1 - y_2|.
\]
By setting \( \delta = \frac{\epsilon}{K} \), if \( |y_1 - y_2| < \delta \), then \( |f(x, y_1) - f(x, y_2)| < \epsilon \), which satisfies the continuity condition. Thus, every Lipschitz continuous function is continuous, but not every continuous function is Lipschitz, as general continuity lacks a bound on the rate of change.

There are more worth discussing on Lipschitz condition, since in real practice, we tend to use it's equivalent condition, which is easier to prove. 
\begin{corollary}
    For functions that are differentiable with respect to \( y \), the Lipschitz condition can be equivalently expressed in terms of the partial derivative. If the partial derivative of \( f(x, y) \) with respect to \( y \) is bounded, i.e.,
\[
\left| \frac{\partial f(x, y)}{\partial y} \right| \leq K \quad \text{for all } (x, y) \in D,
\]
then the function is Lipschitz continuous with respect to \( y \). In this case, the Lipschitz constant \( K \) is exactly the upper bound on the partial derivative.
\end{corollary}
\begin{proof}
To prove that bounded partial derivatives imply Lipschitz continuity, we proceed as follows:

\begin{enumerate}
    \item Assume that \( f(x, y) \) is continuously differentiable with respect to \( y \). Then for any two points \( y_1 \) and \( y_2 \), the fundamental theorem of calculus gives:
\[
f(x, y_1) - f(x, y_2) = \int_{y_2}^{y_1} \frac{\partial f(x, t)}{\partial y} \, dt
\]
    \item Taking the absolute value and applying the boundedness condition \( \left| \frac{\partial f(x, y)}{\partial y} \right| \leq K \), we have:
\[
|f(x, y_1) - f(x, y_2)| \leq \int_{y_2}^{y_1} \left| \frac{\partial f(x, t)}{\partial y} \right| \, dt \leq K |y_1 - y_2|
\]
\end{enumerate}

This confirms that if the partial derivative is bounded, the function satisfies the Lipschitz condition.
\end{proof}
 Thus, Lipschitz continuity can be viewed as an extension of the concept of bounded derivatives, guaranteeing controlled changes in the function's output as \( y \) varies.



\section{Separable ODEs}

\section{First-order linear homogeneous ODEs}

\section{First-order linear non-homogeneous ODEs}

\begin{theorem}[Solution of First-Order Linear Non-Homogeneous ODE]
Consider the first-order linear non-homogeneous ordinary differential equation:
\[
\frac{dy}{dx} + p(x)y = q(x)
\]
where $p(x)$ and $q(x)$ are continuous functions on an interval $I$. The general solution to this equation is given by:
\[
y(x) = \frac{1}{I(x)}\left[\int I(x)q(x)dx + C\right]
\]
where $I(x) = e^{\int p(x)dx}$ is an integrating factor, and $C$ is an arbitrary constant.
\end{theorem}

\begin{proof}
To solve this differential equation, we employ the method of integrating factors. Our goal is to find a function $I(x)$ such that when we multiply both sides of the equation by $I(x)$, the left-hand side becomes the derivative of a product.

We begin by multiplying both sides of the equation by an as-yet-undetermined function $I(x)$:

\[
I(x)\frac{dy}{dx} + I(x)p(x)y = I(x)q(x)
\]

Now, we aim to choose $I(x)$ such that the left-hand side is the derivative of the product $I(x)y$. Expanding this derivative using the product rule, we get:

\[
\frac{d}{dx}(I(x)y) = I(x)\frac{dy}{dx} + y\frac{dI}{dx}
\]

Comparing this with the left-hand side of our equation, we see that we need:

\[
y\frac{dI}{dx} = I(x)p(x)y
\]

This equality should hold for all $y$, so we can conclude:

\[
\frac{dI}{dx} = I(x)p(x)
\]

This is a separable differential equation for $I(x)$. Solving it, we find:

\[
I(x) = e^{\int p(x)dx}
\]

This is our integrating factor. With this choice of $I(x)$, our original equation becomes:

\[
\frac{d}{dx}(I(x)y) = I(x)q(x)
\]

We can now integrate both sides:

\[
I(x)y = \int I(x)q(x)dx + C
\]

where $C$ is an arbitrary constant of integration. Finally, solving for $y$, we obtain our general solution:

\[
y(x) = \frac{1}{I(x)}\left[\int I(x)q(x)dx + C\right]
\]

This completes our proof.
\end{proof}

\section{Second-order linear homogeneous ODEs}

\section{Second-order linear non-homogeneous ODEs}